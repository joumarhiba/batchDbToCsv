package fr.cnamts.ex.batch.item.writer;

import java.util.List;

import org.springframework.batch.item.ItemWriter;
import org.springframework.jdbc.core.namedparam.MapSqlParameterSource;

import fr.cnamts.ex.batch.bo.EmployeeDto;

public class ImportEmployeeWriter  implements ItemWriter<EmployeeDto> {

	@Override
	public void write(List<? extends EmployeeDto> employeeDtos) throws Exception {
		
		MapSqlParameterSource source = new MapSqlParameterSource();

		for (EmployeeDto employeeDto : employeeDtos) {
			if(employeeDto.getPhone().startsWith("1")) {
				continue;
			}
			source.addValue("name", employeeDto.getName()); 
			source.addValue("phone", employeeDto.getPhone());
			source.addValue("email", employeeDto.getEmail());
			source.addValue("country", employeeDto.getCountry());
			source.addValue("createdAt", employeeDto.getCreatedAt());
		}
		
	}

}
